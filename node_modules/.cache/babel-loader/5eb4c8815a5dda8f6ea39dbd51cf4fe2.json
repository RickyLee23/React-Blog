{"ast":null,"code":"import _slicedToArray from\"/Users/lihongshen/Downloads/2022 \\u7528\\u9762\\u8A66\\u8CC7\\u6599/React-Blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/lihongshen/Downloads/2022 \\u7528\\u9762\\u8A66\\u8CC7\\u6599/React-Blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  border: 0;\\n  background: none;\\n  cursor: pointer;\\n  padding: 5px;\\n  border-radius: 5px;\\n  outline: none;\\n  width:33%;\\n  margin-top:20px;\\n  box-shadow: 2px 2px 1px rgb(0 0 0 / 25%);\\n  background: #e9e9e9;\\n  color: rgba(0,0,0,0.7);\\n  :active {\\n    transform: translateY(2px);\\n  }\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 12px 20px;\\n  margin: 8px 0;\\n  display: inline-block;\\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  box-sizing: border-box;\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  margin-bottom: 10px;\\n  letter-spacing: 3px;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  text-align: left;\\n  margin-top: 20vh;\\n  margin-bottom: 20vh;\\n  max-width:50vw;\\n  margin-right:auto;\\n  margin-left:auto;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  color: red;\\n  margin-top:50px;\\n  text-transform:capitalize;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import{useState,useContext}from\"react\";import{useHistory}from\"react-router-dom\";import{login,getMe}from\"../../WebAPI\";import styled from\"styled-components\";import{setAuthToken}from\"../../utils\";import{AuthContext}from\"../../contexts\";import\"./Login.scss\";var ErrorMessage=styled.div(_templateObject());var LoginPageWrapper=styled.div(_templateObject2());var InputInfo=styled.div(_templateObject3());var Input=styled.input(_templateObject4());var Button=styled.button(_templateObject5());export default function LoginPage(){var _useContext=useContext(AuthContext),setUser=_useContext.setUser;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var history=useHistory();var handleSubmit=function handleSubmit(){setErrorMessage(null);login(username,password).then(function(data){if(data.ok===0){return setErrorMessage(data.message);}setAuthToken(data.token);getMe().then(function(response){if(response.ok!==1){setAuthToken(null);// 有出錯，要順便把 token 清空\nreturn setErrorMessage(response.toString());}setUser(response.data);history.push(\"/\");});});};return/*#__PURE__*/_jsxs(LoginPageWrapper,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"login__title\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(InputInfo,{children:[\"Username:\",/*#__PURE__*/_jsx(Input,{value:username,onChange:function onChange(e){return setUsername(e.target.value);}})]}),/*#__PURE__*/_jsxs(InputInfo,{children:[\"Password:\",/*#__PURE__*/_jsx(Input,{type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{className:\"btn__confirm\",children:\"CONFIRM\"}),errorMessage&&/*#__PURE__*/_jsx(ErrorMessage,{children:errorMessage})]})]});}","map":{"version":3,"sources":["/Users/lihongshen/Downloads/2022 用面試資料/React-Blog/src/pages/LoginPage/LoginPage.js"],"names":["useState","useContext","useHistory","login","getMe","styled","setAuthToken","AuthContext","ErrorMessage","div","LoginPageWrapper","InputInfo","Input","input","Button","button","LoginPage","setUser","username","setUsername","password","setPassword","errorMessage","setErrorMessage","history","handleSubmit","then","data","ok","message","token","response","toString","push","e","target","value"],"mappings":"01DAAA,OAASA,QAAT,CAAmBC,UAAnB,KAAqC,OAArC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,KAAT,CAAgBC,KAAhB,KAA6B,cAA7B,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAASC,YAAT,KAA6B,aAA7B,CACA,OAASC,WAAT,KAA4B,gBAA5B,CACA,MAAO,cAAP,CAEA,GAAMC,CAAAA,YAAY,CAAGH,MAAM,CAACI,GAAV,mBAAlB,CAMA,GAAMC,CAAAA,gBAAgB,CAAGL,MAAM,CAACI,GAAV,oBAAtB,CAQA,GAAME,CAAAA,SAAS,CAAGN,MAAM,CAACI,GAAV,oBAAf,CAIA,GAAMG,CAAAA,KAAK,CAAGP,MAAM,CAACQ,KAAV,oBAAX,CASA,GAAMC,CAAAA,MAAM,CAAGT,MAAM,CAACU,MAAV,oBAAZ,CAiBA,cAAe,SAASC,CAAAA,SAAT,EAAqB,iBACdf,UAAU,CAACM,WAAD,CADI,CAC1BU,OAD0B,aAC1BA,OAD0B,eAEFjB,QAAQ,CAAC,EAAD,CAFN,wCAE3BkB,QAF2B,eAEjBC,WAFiB,8BAGFnB,QAAQ,CAAC,EAAD,CAHN,yCAG3BoB,QAH2B,eAGjBC,WAHiB,8BAIMrB,QAAQ,EAJd,yCAI3BsB,YAJ2B,eAIbC,eAJa,eAKlC,GAAMC,CAAAA,OAAO,CAAGtB,UAAU,EAA1B,CAEA,GAAMuB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzBF,eAAe,CAAC,IAAD,CAAf,CACApB,KAAK,CAACe,QAAD,CAAWE,QAAX,CAAL,CAA0BM,IAA1B,CAA+B,SAACC,IAAD,CAAU,CACvC,GAAIA,IAAI,CAACC,EAAL,GAAY,CAAhB,CAAmB,CACjB,MAAOL,CAAAA,eAAe,CAACI,IAAI,CAACE,OAAN,CAAtB,CACD,CACDvB,YAAY,CAACqB,IAAI,CAACG,KAAN,CAAZ,CAEA1B,KAAK,GAAGsB,IAAR,CAAa,SAACK,QAAD,CAAc,CACzB,GAAIA,QAAQ,CAACH,EAAT,GAAgB,CAApB,CAAuB,CACrBtB,YAAY,CAAC,IAAD,CAAZ,CAAoB;AACpB,MAAOiB,CAAAA,eAAe,CAACQ,QAAQ,CAACC,QAAT,EAAD,CAAtB,CACD,CACDf,OAAO,CAACc,QAAQ,CAACJ,IAAV,CAAP,CACAH,OAAO,CAACS,IAAR,CAAa,GAAb,EACD,CAPD,EAQD,CAdD,EAeD,CAjBD,CAmBA,mBACE,MAAC,gBAAD,yBACE,YAAK,SAAS,CAAC,cAAf,mBADF,cAEE,cAAM,QAAQ,CAAER,YAAhB,wBACE,MAAC,SAAD,qCAEE,KAAC,KAAD,EACE,KAAK,CAAEP,QADT,CAEE,QAAQ,CAAE,kBAACgB,CAAD,QAAOf,CAAAA,WAAW,CAACe,CAAC,CAACC,MAAF,CAASC,KAAV,CAAlB,EAFZ,EAFF,GADF,cAQE,MAAC,SAAD,qCAEE,KAAC,KAAD,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAEhB,QAFT,CAGE,QAAQ,CAAE,kBAACc,CAAD,QAAOb,CAAAA,WAAW,CAACa,CAAC,CAACC,MAAF,CAASC,KAAV,CAAlB,EAHZ,EAFF,GARF,cAgBE,KAAC,MAAD,EAAQ,SAAS,CAAC,cAAlB,qBAhBF,CAiBGd,YAAY,eAAI,KAAC,YAAD,WAAeA,YAAf,EAjBnB,GAFF,GADF,CAwBD","sourcesContent":["import { useState, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { login, getMe } from \"../../WebAPI\";\nimport styled from \"styled-components\";\nimport { setAuthToken } from \"../../utils\";\nimport { AuthContext } from \"../../contexts\";\nimport \"./Login.scss\"\n\nconst ErrorMessage = styled.div`\n  color: red;\n  margin-top:50px;\n  text-transform:capitalize;\n`;\n\nconst LoginPageWrapper = styled.div`\n  text-align: left;\n  margin-top: 20vh;\n  margin-bottom: 20vh;\n  max-width:50vw;\n  margin-right:auto;\n  margin-left:auto;\n`;\nconst InputInfo = styled.div`\n  margin-bottom: 10px;\n  letter-spacing: 3px;\n`;\nconst Input = styled.input`\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  display: inline-block;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n`;\nconst Button = styled.button`\n  border: 0;\n  background: none;\n  cursor: pointer;\n  padding: 5px;\n  border-radius: 5px;\n  outline: none;\n  width:33%;\n  margin-top:20px;\n  box-shadow: 2px 2px 1px rgb(0 0 0 / 25%);\n  background: #e9e9e9;\n  color: rgba(0,0,0,0.7);\n  :active {\n    transform: translateY(2px);\n  }\n`;\n\nexport default function LoginPage() {\n  const { setUser } = useContext(AuthContext);\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState();\n  const history = useHistory();\n\n  const handleSubmit = () => {\n    setErrorMessage(null);\n    login(username, password).then((data) => {\n      if (data.ok === 0) {\n        return setErrorMessage(data.message);\n      }\n      setAuthToken(data.token);\n\n      getMe().then((response) => {\n        if (response.ok !== 1) {\n          setAuthToken(null); // 有出錯，要順便把 token 清空\n          return setErrorMessage(response.toString());\n        }\n        setUser(response.data);\n        history.push(\"/\");\n      });\n    });\n  };\n\n  return (\n    <LoginPageWrapper>\n      <div className=\"login__title\">Login</div>\n      <form onSubmit={handleSubmit}>\n        <InputInfo>\n          Username:\n          <Input\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n          />\n        </InputInfo>\n        <InputInfo>\n          Password:\n          <Input\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n        </InputInfo>\n        <Button className=\"btn__confirm\">CONFIRM</Button>\n        {errorMessage && <ErrorMessage>{errorMessage}</ErrorMessage>}\n      </form>\n    </LoginPageWrapper>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}